<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real-time Analytics Dashboard</title>
    <style>
        /* Analytics Dashboard Styles */
        .analytics-dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr 350px;
            grid-template-rows: auto 1fr;
            gap: 2rem;
            padding: 2rem;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #f8fafc;
            min-height: 100vh;
        }

        .dashboard-header {
            grid-column: 1 / -1;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(71, 85, 105, 0.3);
            border-radius: 16px;
            padding: 2rem;
        }

        .header-info {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .header-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #f8fafc;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .header-stats {
            display: flex;
            gap: 2rem;
        }

        .header-stat {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #10b981;
            font-family: 'Courier New', monospace;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .header-controls {
            display: flex;
            gap: 1rem;
        }

        .control-btn {
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .control-btn.recording {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            animation: recordingPulse 2s infinite;
        }

        @keyframes recordingPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .charts-section {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .chart-panel {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(71, 85, 105, 0.3);
            border-radius: 16px;
            padding: 2rem;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .chart-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #f8fafc;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .chart-controls {
            display: flex;
            gap: 0.5rem;
        }

        .chart-tab {
            padding: 0.5rem 1rem;
            background: rgba(71, 85, 105, 0.2);
            border: 1px solid rgba(71, 85, 105, 0.3);
            border-radius: 6px;
            color: #cbd5e1;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s ease;
        }

        .chart-tab:hover,
        .chart-tab.active {
            background: #2563eb;
            color: white;
            border-color: #2563eb;
        }

        .chart-container {
            height: 300px;
            background: rgba(71, 85, 105, 0.1);
            border-radius: 10px;
            position: relative;
            overflow: hidden;
        }

        .chart-placeholder {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #94a3b8;
            text-align: center;
            border: 2px dashed rgba(71, 85, 105, 0.3);
            border-radius: 10px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        .metric-card {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(71, 85, 105, 0.3);
            border-radius: 16px;
            padding: 1.5rem;
        }

        .metric-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .metric-name {
            font-size: 1rem;
            font-weight: 600;
            color: #f8fafc;
        }

        .metric-trend {
            font-size: 0.8rem;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-weight: 500;
        }

        .trend-up {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
        }

        .trend-down {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        .trend-stable {
            background: rgba(148, 163, 184, 0.2);
            color: #94a3b8;
        }

        .metric-value-large {
            font-size: 2.5rem;
            font-weight: 700;
            color: #10b981;
            font-family: 'Courier New', monospace;
            margin-bottom: 0.5rem;
        }

        .metric-description {
            font-size: 0.85rem;
            color: #94a3b8;
            line-height: 1.4;
        }

        .analytics-sidebar {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .data-export {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(71, 85, 105, 0.3);
            border-radius: 16px;
            padding: 1.5rem;
        }

        .export-option {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            margin: 0.5rem 0;
            background: rgba(71, 85, 105, 0.2);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .export-option:hover {
            background: rgba(71, 85, 105, 0.4);
        }

        .export-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .export-icon {
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
        }

        .export-details {
            flex: 1;
        }

        .export-name {
            font-weight: 600;
            color: #f8fafc;
            margin-bottom: 0.25rem;
        }

        .export-description {
            font-size: 0.8rem;
            color: #94a3b8;
        }

        .export-size {
            font-size: 0.8rem;
            color: #10b981;
            font-family: 'Courier New', monospace;
        }

        .performance-monitor {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(71, 85, 105, 0.3);
            border-radius: 16px;
            padding: 1.5rem;
        }

        .performance-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-top: 1rem;
        }

        .performance-item {
            background: rgba(71, 85, 105, 0.2);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
        }

        .performance-value {
            font-size: 1.3rem;
            font-weight: 700;
            color: #10b981;
            font-family: 'Courier New', monospace;
            margin-bottom: 0.25rem;
        }

        .performance-label {
            font-size: 0.8rem;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .system-health {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(71, 85, 105, 0.3);
            border-radius: 16px;
            padding: 1.5rem;
        }

        .health-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid rgba(71, 85, 105, 0.3);
        }

        .health-item:last-child {
            border-bottom: none;
        }

        .health-name {
            color: #cbd5e1;
            font-size: 0.9rem;
        }

        .health-status {
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .status-healthy {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
        }

        .status-warning {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }

        .status-error {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        .data-summary {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(71, 85, 105, 0.3);
            border-radius: 16px;
            padding: 1.5rem;
        }

        .summary-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-top: 1rem;
        }

        .summary-stat {
            text-align: center;
            padding: 1rem;
            background: rgba(71, 85, 105, 0.2);
            border-radius: 8px;
        }

        .summary-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #10b981;
            font-family: 'Courier New', monospace;
            margin-bottom: 0.25rem;
        }

        .summary-label {
            font-size: 0.8rem;
            color: #94a3b8;
        }

        /* Responsive Design */
        @media (max-width: 1400px) {
            .analytics-dashboard {
                grid-template-columns: 1fr 1fr;
            }
            
            .analytics-sidebar {
                grid-column: 1 / -1;
                grid-row: 3;
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 2rem;
            }
        }

        @media (max-width: 768px) {
            .analytics-dashboard {
                grid-template-columns: 1fr;
                gap: 1.5rem;
                padding: 1rem;
            }
            
            .dashboard-header {
                flex-direction: column;
                gap: 1.5rem;
                text-align: center;
            }
            
            .header-stats {
                justify-content: center;
            }
            
            .charts-section {
                grid-column: 1;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="analytics-dashboard">
        <!-- Dashboard Header -->
        <div class="dashboard-header">
            <div class="header-info">
                <div class="header-title">
                    <i class="fas fa-chart-pie" style="color: #2563eb;"></i>
                    Real-time Analytics Dashboard
                </div>
                <div class="header-stats">
                    <div class="header-stat">
                        <div class="stat-value" id="total-distance">12.4</div>
                        <div class="stat-label">Total Distance (km)</div>
                    </div>
                    <div class="header-stat">
                        <div class="stat-value" id="operation-time">4:32</div>
                        <div class="stat-label">Operation Time (h)</div>
                    </div>
                    <div class="header-stat">
                        <div class="stat-value" id="efficiency-score">94</div>
                        <div class="stat-label">Efficiency Score</div>
                    </div>
                </div>
            </div>
            <div class="header-controls">
                <button class="control-btn" id="start-recording" onclick="toggleRecording()">
                    <i class="fas fa-play"></i>
                    Start Recording
                </button>
                <button class="control-btn" onclick="exportAllData()">
                    <i class="fas fa-download"></i>
                    Export All
                </button>
                <button class="control-btn" onclick="clearData()">
                    <i class="fas fa-trash"></i>
                    Clear Data
                </button>
            </div>
        </div>

        <!-- Charts Section -->
        <div class="charts-section">
            <!-- Performance Chart -->
            <div class="chart-panel">
                <div class="chart-header">
                    <div class="chart-title">
                        <i class="fas fa-chart-line"></i>
                        Performance Metrics
                    </div>
                    <div class="chart-controls">
                        <button class="chart-tab active" onclick="switchChart('velocity')">Velocity</button>
                        <button class="chart-tab" onclick="switchChart('error')">Error</button>
                        <button class="chart-tab" onclick="switchChart('efficiency')">Efficiency</button>
                        <button class="chart-tab" onclick="switchChart('battery')">Power</button>
                    </div>
                </div>
                <div class="chart-container">
                    <div class="chart-placeholder">
                        <div>
                            <i class="fas fa-chart-area" style="font-size: 3rem; margin-bottom: 1rem; display: block;"></i>
                            Real-time performance charts<br>
                            <small>Live data visualization with Chart.js integration</small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Trajectory Analysis -->
            <div class="chart-panel">
                <div class="chart-header">
                    <div class="chart-title">
                        <i class="fas fa-route"></i>
                        Trajectory Analysis
                    </div>
                    <div class="chart-controls">
                        <button class="chart-tab active" onclick="switchTrajectoryView('2d')">2D Path</button>
                        <button class="chart-tab" onclick="switchTrajectoryView('3d')">3D View</button>
                        <button class="chart-tab" onclick="switchTrajectoryView('heatmap')">Heatmap</button>
                    </div>
                </div>
                <div class="chart-container">
                    <div class="chart-placeholder">
                        <div>
                            <i class="fas fa-map" style="font-size: 3rem; margin-bottom: 1rem; display: block;"></i>
                            Robot trajectory visualization<br>
                            <small>Path analysis and optimization insights</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Key Metrics -->
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-header">
                    <div class="metric-name">Average Velocity</div>
                    <div class="metric-trend trend-up">â†— +5.2%</div>
                </div>
                <div class="metric-value-large" id="avg-velocity">0.85</div>
                <div class="metric-description">
                    m/s average speed across all operations. Optimal range: 0.6-1.2 m/s for current tasks.
                </div>
            </div>

            <div class="metric-card">
                <div class="metric-header">
                    <div class="metric-name">Path Accuracy</div>
                    <div class="metric-trend trend-stable">â†’ 0.1%</div>
                </div>
                <div class="metric-value-large" id="path-accuracy">96.2</div>
                <div class="metric-description">
                    Percentage of time robot stayed within acceptable path deviation (Â±0.1m tolerance).
                </div>
            </div>

            <div class="metric-card">
                <div class="metric-header">
                    <div class="metric-name">Energy Efficiency</div>
                    <div class="metric-trend trend-up">â†— +2.8%</div>
                </div>
                <div class="metric-value-large" id="energy-efficiency">87.4</div>
                <div class="metric-description">
                    Energy usage optimization score based on distance traveled per unit of power consumed.
                </div>
            </div>

            <div class="metric-card">
                <div class="metric-header">
                    <div class="metric-name">Mission Success</div>
                    <div class="metric-trend trend-stable">â†’ 0.0%</div>
                </div>
                <div class="metric-value-large" id="mission-success">100</div>
                <div class="metric-description">
                    Percentage of successfully completed tasks without manual intervention or errors.
                </div>
            </div>
        </div>

        <!-- Analytics Sidebar -->
        <div class="analytics-sidebar">
            <!-- Data Export Options -->
            <div class="data-export">
                <h3 style="margin: 0 0 1rem 0; color: #f8fafc; display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-file-export" style="color: #2563eb;"></i>
                    Export Options
                </h3>
                
                <div class="export-option" onclick="exportExcel()">
                    <div class="export-info">
                        <div class="export-icon">
                            <i class="fas fa-file-excel"></i>
                        </div>
                        <div class="export-details">
                            <div class="export-name">Excel Report</div>
                            <div class="export-description">Complete dataset with analysis</div>
                        </div>
                    </div>
                    <div class="export-size" id="excel-size">2.4 MB</div>
                </div>

                <div class="export-option" onclick="exportCSV()">
                    <div class="export-info">
                        <div class="export-icon">
                            <i class="fas fa-file-csv"></i>
                        </div>
                        <div class="export-details">
                            <div class="export-name">CSV Data</div>
                            <div class="export-description">Raw sensor and position data</div>
                        </div>
                    </div>
                    <div class="export-size" id="csv-size">1.8 MB</div>
                </div>

                <div class="export-option" onclick="exportJSON()">
                    <div class="export-info">
                        <div class="export-icon">
                            <i class="fas fa-file-code"></i>
                        </div>
                        <div class="export-details">
                            <div class="export-name">JSON Export</div>
                            <div class="export-description">Structured data for integration</div>
                        </div>
                    </div>
                    <div class="export-size" id="json-size">3.1 MB</div>
                </div>

                <div class="export-option" onclick="exportPDF()">
                    <div class="export-info">
                        <div class="export-icon">
                            <i class="fas fa-file-pdf"></i>
                        </div>
                        <div class="export-details">
                            <div class="export-name">PDF Report</div>
                            <div class="export-description">Executive summary with charts</div>
                        </div>
                    </div>
                    <div class="export-size" id="pdf-size">892 KB</div>
                </div>
            </div>

            <!-- Performance Monitor -->
            <div class="performance-monitor">
                <h3 style="margin: 0 0 1rem 0; color: #f8fafc; display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-tachometer-alt" style="color: #2563eb;"></i>
                    System Performance
                </h3>
                
                <div class="performance-grid">
                    <div class="performance-item">
                        <div class="performance-value" id="cpu-usage">23%</div>
                        <div class="performance-label">CPU Usage</div>
                    </div>
                    <div class="performance-item">
                        <div class="performance-value" id="memory-usage">1.2GB</div>
                        <div class="performance-label">Memory</div>
                    </div>
                    <div class="performance-item">
                        <div class="performance-value" id="network-latency">12ms</div>
                        <div class="performance-label">Network</div>
                    </div>
                    <div class="performance-item">
                        <div class="performance-value" id="data-rate">45Hz</div>
                        <div class="performance-label">Data Rate</div>
                    </div>
                </div>
            </div>

            <!-- System Health -->
            <div class="system-health">
                <h3 style="margin: 0 0 1rem 0; color: #f8fafc; display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-heartbeat" style="color: #2563eb;"></i>
                    System Health
                </h3>
                
                <div class="health-item">
                    <span class="health-name">ROS Connection</span>
                    <span class="health-status status-healthy">Healthy</span>
                </div>
                <div class="health-item">
                    <span class="health-name">Sensors</span>
                    <span class="health-status status-healthy">All Active</span>
                </div>
                <div class="health-item">
                    <span class="health-name">Navigation</span>
                    <span class="health-status status-healthy">Optimal</span>
                </div>
                <div class="health-item">
                    <span class="health-name">Power System</span>
                    <span class="health-status status-warning">85% Battery</span>
                </div>
                <div class="health-item">
                    <span class="health-name">Data Storage</span>
                    <span class="health-status status-healthy">67% Used</span>
                </div>
            </div>

            <!-- Data Summary -->
            <div class="data-summary">
                <h3 style="margin: 0 0 1rem 0; color: #f8fafc; display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-database" style="color: #2563eb;"></i>
                    Data Summary
                </h3>
                
                <div class="summary-stats">
                    <div class="summary-stat">
                        <div class="summary-value" id="total-records">24,847</div>
                        <div class="summary-label">Total Records</div>
                    </div>
                    <div class="summary-stat">
                        <div class="summary-value" id="session-duration">4:32:18</div>
                        <div class="summary-label">Session Time</div>
                    </div>
                    <div class="summary-stat">
                        <div class="summary-value" id="data-points">156K</div>
                        <div class="summary-label">Data Points</div>
                    </div>
                    <div class="summary-stat">
                        <div class="summary-value" id="storage-used">4.7GB</div>
                        <div class="summary-label">Storage Used</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Real-time Analytics Dashboard
        let recordingActive = false;
        let dataPoints = [];
        let updateInterval = null;
        let performanceInterval = null;

        // Simulated data for demonstration
        const analyticsData = {
            velocity: {
                current: 0.85,
                history: [],
                trend: 0.002
            },
            accuracy: {
                current: 96.2,
                history: [],
                trend: 0.01
            },
            efficiency: {
                current: 87.4,
                history: [],
                trend: 0.05
            },
            power: {
                battery: 85,
                consumption: 23.4,
                trend: -0.1
            }
        };

        function toggleRecording() {
            const button = document.getElementById('start-recording');
            
            if (!recordingActive) {
                // Start recording
                recordingActive = true;
                button.innerHTML = '<i class="fas fa-stop"></i> Stop Recording';
                button.classList.add('recording');
                
                startDataCollection();
                console.log('ðŸ“Š Started data recording');
            } else {
                // Stop recording
                recordingActive = false;
                button.innerHTML = '<i class="fas fa-play"></i> Start Recording';
                button.classList.remove('recording');
                
                stopDataCollection();
                console.log('ðŸ“Š Stopped data recording');
            }
        }

        function startDataCollection() {
            if (updateInterval) return;
            
            updateInterval = setInterval(() => {
                updateAnalyticsData();
                updateDisplayValues();
            }, 1000);
            
            performanceInterval = setInterval(() => {
                updatePerformanceMetrics();
            }, 500);
        }

        function stopDataCollection() {
            if (updateInterval) {
                clearInterval(updateInterval);
                updateInterval = null;
            }
            
            if (performanceInterval) {
                clearInterval(performanceInterval);
                performanceInterval = null;
            }
        }

        function updateAnalyticsData() {
            // Simulate real-time data updates
            Object.keys(analyticsData).forEach(metric => {
                if (metric === 'power') {
                    analyticsData[metric].battery = Math.max(0, analyticsData[metric].battery + analyticsData[metric].trend);
                    analyticsData[metric].consumption = 20 + Math.random() * 10;
                } else {
                    const data = analyticsData[metric];
                    data.current += data.trend + (Math.random() - 0.5) * 0.1;
                    
                    // Keep values in reasonable ranges
                    if (metric === 'velocity') {
                        data.current = Math.max(0, Math.min(2.0, data.current));
                    } else if (metric === 'accuracy' || metric === 'efficiency') {
                        data.current = Math.max(0, Math.min(100, data.current));
                    }
                    
                    data.history.push(data.current);
                    if (data.history.length > 100) {
                        data.history.shift();
                    }
                }
            });
            
            // Create data point for collection
            const dataPoint = {
                timestamp: new Date().toISOString(),
                velocity: analyticsData.velocity.current,
                accuracy: analyticsData.accuracy.current,
                efficiency: analyticsData.efficiency.current,
                battery: analyticsData.power.battery,
                consumption: analyticsData.power.consumption
            };
            
            dataPoints.push(dataPoint);
            
            // Limit stored data points
            if (dataPoints.length > 10000) {
                dataPoints.shift();
            }
        }

        function updateDisplayValues() {
            // Update main metrics
            document.getElementById('avg-velocity').textContent = analyticsData.velocity.current.toFixed(2);
            document.getElementById('path-accuracy').textContent = analyticsData.accuracy.current.toFixed(1);
            document.getElementById('energy-efficiency').textContent = analyticsData.efficiency.current.toFixed(1);
            document.getElementById('mission-success').textContent = '100';
            
            // Update header stats
            const totalDistance = (analyticsData.velocity.current * 4.5).toFixed(1);
            document.getElementById('total-distance').textContent = totalDistance;
            
            // Update data summary
            document.getElementById('total-records').textContent = dataPoints.length.toLocaleString();
            document.getElementById('data-points').textContent = (dataPoints.length * 8).toLocaleString();
            
            // Update file sizes based on data points
            const baseSize = dataPoints.length * 0.1; // KB per data point
            document.getElementById('excel-size').textContent = (baseSize * 5).toFixed(1) + ' KB';
            document.getElementById('csv-size').textContent = (baseSize * 3).toFixed(1) + ' KB';
            document.getElementById('json-size').textContent = (baseSize * 7).toFixed(1) + ' KB';
            document.getElementById('pdf-size').textContent = Math.max(500, baseSize * 2).toFixed(0) + ' KB';
        }

        function updatePerformanceMetrics() {
            // Simulate system performance metrics
            const cpuUsage = 20 + Math.random() * 15;
            const memoryUsage = 1.0 + Math.random() * 0.5;
            const networkLatency = 8 + Math.random() * 8;
            const dataRate = 40 + Math.random() * 10;
            
            document.getElementById('cpu-usage').textContent = Math.round(cpuUsage) + '%';
            document.getElementById('memory-usage').textContent = memoryUsage.toFixed(1) + 'GB';
            document.getElementById('network-latency').textContent = Math.round(networkLatency) + 'ms';
            document.getElementById('data-rate').textContent = Math.round(dataRate) + 'Hz';
            
            // Update battery in health section
            const batteryPercent = analyticsData.power.battery;
            const batteryStatus = document.querySelector('.health-item:nth-child(4) .health-status');
            batteryStatus.textContent = Math.round(batteryPercent) + '% Battery';
            
            if (batteryPercent > 50) {
                batteryStatus.className = 'health-status status-healthy';
            } else if (batteryPercent > 20) {
                batteryStatus.className = 'health-status status-warning';
            } else {
                batteryStatus.className = 'health-status status-error';
            }
        }

        function switchChart(chartType) {
            // Update chart tab states
            document.querySelectorAll('.chart-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            console.log(`Switching to ${chartType} chart`);
            // Here you would update the actual chart display
        }

        function switchTrajectoryView(viewType) {
            // Update trajectory view tab states
            const trajectoryTabs = document.querySelectorAll('.chart-panel:nth-child(2) .chart-tab');
            trajectoryTabs.forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            
            console.log(`Switching to ${viewType} trajectory view`);
        }

        // Export Functions
        function exportExcel() {
            if (dataPoints.length === 0) {
                alert('No data to export. Start recording first.');
                return;
            }
            
            console.log('ðŸ“Š Exporting Excel report with', dataPoints.length, 'data points');
            
            // Simulate download
            const blob = new Blob([JSON.stringify(dataPoints, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `robot_analytics_${new Date().toISOString().slice(0,10)}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            showNotification('Excel report exported successfully!', 'success');
        }

        function exportCSV() {
            if (dataPoints.length === 0) {
                alert('No data to export. Start recording first.');
                return;
            }
            
            console.log('ðŸ“Š Exporting CSV data');
            
            // Convert to CSV format
            let csv = 'Timestamp,Velocity,Accuracy,Efficiency,Battery,Consumption\n';
            dataPoints.forEach(point => {
                csv += `${point.timestamp},${point.velocity.toFixed(3)},${point.accuracy.toFixed(2)},${point.efficiency.toFixed(2)},${point.battery.toFixed(1)},${point.consumption.toFixed(2)}\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `robot_data_${new Date().toISOString().slice(0,10)}.csv`;
            a.click();
            URL.revokeObjectURL(url);
            
            showNotification('CSV data exported successfully!', 'success');
        }

        function exportJSON() {
            if (dataPoints.length === 0) {
                alert('No data to export. Start recording first.');
                return;
            }
            
            console.log('ðŸ“Š Exporting JSON data');
            showNotification('JSON export feature coming soon!', 'info');
        }

        function exportPDF() {
            console.log('ðŸ“Š Exporting PDF report');
            showNotification('PDF report generation feature coming soon!', 'info');
        }

        function exportAllData() {
            if (dataPoints.length === 0) {
                alert('No data to export. Start recording first.');
                return;
            }
            
            console.log('ðŸ“Š Exporting all data formats');
            exportCSV();
            setTimeout(() => exportExcel(), 1000);
        }

        function clearData() {
            if (confirm('Are you sure you want to clear all collected data? This action cannot be undone.')) {
                dataPoints = [];
                Object.keys(analyticsData).forEach(metric => {
                    if (analyticsData[metric].history) {
                        analyticsData[metric].history = [];
                    }
                });
                
                // Reset displays
                document.getElementById('total-records').textContent = '0';
                document.getElementById('data-points').textContent = '0';
                
                console.log('ðŸ“Š All data cleared');
                showNotification('All analytics data has been cleared.', 'info');
            }
        }

        function showNotification(message, type = 'info') {
            // Create notification (you can enhance this with a proper notification system)
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 1rem 1.5rem;
                background: ${type === 'success' ? '#22c55e' : type === 'error' ? '#ef4444' : '#2563eb'};
                color: white;
                border-radius: 8px;
                z-index: 10000;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                opacity: 0;
                transform: translateX(100%);
                transition: all 0.3s ease;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '1';
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => document.body.removeChild(notification), 300);
            }, 3000);
        }

        // Initialize the analytics dashboard
        window.addEventListener('load', function() {
            console.log('ðŸ“Š Real-time Analytics Dashboard initialized');
            
            // Start with demo data updates
            setTimeout(() => {
                updateAnalyticsData();
                updateDisplayValues();
                updatePerformanceMetrics();
            }, 1000);
            
            // Update performance metrics periodically
            setInterval(() => {
                if (!recordingActive) {
                    updatePerformanceMetrics();
                }
            }, 2000);
        });
    </script>
</body>
</html>